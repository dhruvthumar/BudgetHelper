<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>Budget</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
:root{--bg:#f5f5f5;--c:#fff;--t:#000;--t2:#555;--t3:#999;--br:#e8e8e8;--bl:#4a90d9;--pu:#9b59b6;--gn:#00c896;--rd:#ff5252}
body{font-family:-apple-system,system-ui,sans-serif;background:var(--bg);color:var(--t);font-size:14px;overscroll-behavior:none}
button,select,input{font:inherit;-webkit-appearance:none;appearance:none}
.n{background:var(--c);border-bottom:1px solid var(--br);padding:10px 12px;position:sticky;top:0;z-index:50}
.ni{max-width:600px;margin:0 auto;display:flex;align-items:center;gap:8px;justify-content:space-between}
.logo{font-weight:700;font-size:15px;white-space:nowrap}
.tabs{display:flex;gap:4px;flex:1;justify-content:center}
.tab{padding:6px 12px;border:1px solid var(--br);background:var(--c);border-radius:20px;cursor:pointer;font-size:12px;font-weight:600;white-space:nowrap}
.tab.on{color:#fff}
.tab[data-v=user1].on{background:var(--bl);border-color:var(--bl)}
.tab[data-v=user2].on{background:var(--pu);border-color:var(--pu)}
.tab[data-v=household].on{background:var(--t);border-color:var(--t)}
.nr{display:flex;gap:6px;align-items:center}
.sel{padding:5px 8px;border:1px solid var(--br);border-radius:6px;background:var(--c);font-size:12px;font-weight:500}
.ib{width:32px;height:32px;border:1px solid var(--br);border-radius:6px;background:var(--c);cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px}
.m{max-width:600px;margin:0 auto;padding:12px}

/* Balance */
.bal{background:var(--c);border-radius:14px;padding:20px;text-align:center;margin-bottom:12px}
.bal-l{font-size:10px;color:var(--t3);text-transform:uppercase;letter-spacing:.06em}
.bal-v{font-size:32px;font-weight:700;margin:4px 0 12px}
.bal-r{display:flex;justify-content:center;gap:24px}
.bal-i{text-align:center}
.bal-i .l{font-size:10px;color:var(--t3);text-transform:uppercase;letter-spacing:.04em}
.bal-i .v{font-size:16px;font-weight:600;margin-top:2px}
.green{color:var(--gn)}.red{color:var(--rd)}
.bal-p{font-size:11px;color:var(--t2);margin-top:2px}

/* Comparison */
.cmp{background:var(--c);border-radius:14px;padding:16px;margin-bottom:12px;display:none}
.cmp.show{display:block}
.cmp-t{font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:.06em;color:var(--t2);margin-bottom:12px}
.cmp-row{margin-bottom:12px}
.cmp-row:last-child{margin-bottom:0}
.cmp-rl{font-size:11px;color:var(--t2);margin-bottom:4px}
.bar-wrap{height:22px;background:var(--bg);border-radius:4px;overflow:hidden;display:flex}
.bar-f{height:100%;display:flex;align-items:center;justify-content:center;font-size:10px;font-weight:700;color:#fff;min-width:30px;transition:width .3s}
.bar-f.b1{background:var(--bl)}.bar-f.b2{background:var(--pu)}
.cmp-vals{display:flex;justify-content:space-between;font-size:11px;margin-top:4px}
.cmp-vals span:first-child{color:var(--bl)}
.cmp-vals span:last-child{color:var(--pu)}
.cmp-totals{display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;margin-top:14px;text-align:center;padding-top:14px;border-top:1px solid var(--br)}
.cmp-totals .v{font-size:16px;font-weight:600;margin-top:2px}

/* Add */
.add{display:flex;justify-content:center;margin-bottom:12px}
.add-b{padding:8px 20px;border:none;border-radius:50px;cursor:pointer;font-weight:600;font-size:13px;color:#fff;background:var(--t)}
.add-b.u1{background:var(--bl)}.add-b.u2{background:var(--pu)}

/* Form */
.fm{background:var(--c);border-radius:14px;padding:12px;margin-bottom:12px;display:none}
.fm.show{display:block}
.fm-u{display:flex;gap:6px;margin-bottom:10px}
.fm-ub{flex:1;padding:8px;border:1px solid var(--br);background:var(--c);border-radius:6px;cursor:pointer;font-size:12px;font-weight:600;text-align:center}
.fm-ub.on{color:#fff}
.fm-ub.u1.on{background:var(--bl);border-color:var(--bl)}
.fm-ub.u2.on{background:var(--pu);border-color:var(--pu)}
.fg{display:grid;grid-template-columns:1fr 1fr;gap:8px}
.fi{padding:8px;border:1px solid var(--br);border-radius:6px;width:100%;font-size:13px;background:var(--c)}
.fi:focus{outline:none;border-color:var(--t)}
.fa{grid-column:span 2;display:flex;gap:6px;justify-content:flex-end}
.btn{padding:8px 16px;border:none;border-radius:6px;cursor:pointer;font-weight:600;font-size:13px}
.bp{background:var(--t);color:#fff}
.bs{background:var(--bg);color:var(--t2)}

/* Section */
.sec{background:var(--c);border-radius:14px;padding:12px;margin-bottom:12px}
.st{font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:.06em;color:var(--t2);margin-bottom:10px}
.ch{height:160px;position:relative}

/* Budget bars */
.bi{padding:8px;background:var(--bg);border-radius:6px;margin-bottom:6px}
.bi:last-child{margin-bottom:0}
.bh{display:flex;justify-content:space-between;font-size:12px;margin-bottom:4px}
.bb{height:3px;background:var(--br);border-radius:2px;overflow:hidden}
.bf{height:100%;border-radius:2px;background:var(--t);transition:width .3s}
.bf.w{background:#ffb700}.bf.o{background:var(--rd)}

/* Transactions */
.ti{display:flex;align-items:center;gap:8px;padding:8px 0;border-bottom:1px solid var(--br)}
.ti:last-child{border-bottom:none}
.av{width:28px;height:28px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:10px;font-weight:700;color:#fff;flex-shrink:0}
.av.a1{background:var(--bl)}.av.a2{background:var(--pu)}
.tl{flex:1;min-width:0}
.td{font-size:13px;font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.tm{font-size:11px;color:var(--t3);display:flex;gap:6px;align-items:center;margin-top:1px}
.tc{background:var(--bg);padding:1px 5px;border-radius:3px;font-size:10px;text-transform:uppercase}
.tr{display:flex;align-items:center;gap:8px;flex-shrink:0}
.ta{font-weight:600;font-size:13px}
.db{background:none;border:none;color:var(--t3);cursor:pointer;font-size:16px;padding:2px 4px;line-height:1}
.db:active{color:var(--rd)}

/* Empty / Loading */
.empty{text-align:center;color:var(--t3);padding:24px;font-size:13px}
.spin{width:18px;height:18px;border:2px solid var(--br);border-top-color:var(--t);border-radius:50%;animation:sp .5s linear infinite;margin:20px auto}
@keyframes sp{to{transform:rotate(360deg)}}

/* Charts grid */
.cg{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:12px}

/* Modal */
.mo{display:none;position:fixed;inset:0;z-index:100}
.mo.show{display:flex;align-items:flex-start;justify-content:center;padding-top:10vh}
.mo-bg{position:fixed;inset:0;background:rgba(0,0,0,.4)}
.mo-b{position:relative;width:90%;max-width:380px;background:var(--c);border-radius:14px;max-height:80vh;overflow:auto;z-index:1}
.mo-h{display:flex;justify-content:space-between;align-items:center;padding:12px;border-bottom:1px solid var(--br)}
.mo-h h2{font-size:15px}
.mo-x{background:none;border:none;font-size:22px;cursor:pointer;color:var(--t3);padding:0 4px}
.mo-d{padding:12px}
.mo-f{padding:12px;border-top:1px solid var(--br);text-align:right}
.sg{margin-bottom:14px}
.sl{font-size:12px;font-weight:600;margin-bottom:4px;display:block}
.si{width:100%;padding:8px;border:1px solid var(--br);border-radius:6px;font-size:13px}
.sh{font-size:11px;color:var(--t3);margin-top:3px}
.sr{display:grid;grid-template-columns:1fr 1fr;gap:8px}
.ci{display:flex;justify-content:space-between;align-items:center;padding:6px 8px;background:var(--bg);border-radius:6px;margin-bottom:4px;font-size:12px}
.ci input{width:70px;padding:4px;border:1px solid var(--br);border-radius:4px;text-align:right;font-size:12px}

/* Toast */
.toast{position:fixed;bottom:12px;left:50%;transform:translateX(-50%);padding:8px 16px;background:var(--t);color:#fff;border-radius:8px;font-size:13px;font-weight:500;z-index:200;white-space:nowrap}
.toast.ok{background:var(--gn)}.toast.err{background:var(--rd)}

@media(max-width:400px){
  .cg{grid-template-columns:1fr}
  .fg{grid-template-columns:1fr}
  .fa{grid-column:span 1}
  .tabs{gap:2px}
  .tab{padding:5px 8px;font-size:11px}
  .bal-v{font-size:26px}
}
</style>
</head>
<body>
<nav class="n"><div class="ni">
  <div class="logo">◐ Budget</div>
  <div class="tabs">
    <button class="tab" data-v="user1" id="t1">Me</button>
    <button class="tab" data-v="user2" id="t2">Partner</button>
    <button class="tab on" data-v="household" id="t3">Both</button>
  </div>
  <div class="nr">
    <select id="mo" class="sel"></select>
    <button class="ib" id="setBtn">⚙</button>
  </div>
</div></nav>

<main class="m">
  <!-- Individual View -->
  <div class="bal" id="balCard">
    <div class="bal-l">Balance</div>
    <div class="bal-v" id="bal">$0</div>
    <div class="bal-r">
      <div class="bal-i"><span class="l">Income</span><span class="v green" id="inc">$0</span><div class="bal-p" id="incP"></div></div>
      <div class="bal-i"><span class="l">Expenses</span><span class="v" id="exp">$0</span><div class="bal-p" id="expP"></div></div>
    </div>
  </div>

  <!-- Household Comparison -->
  <div class="cmp" id="cmpView">
    <div class="cmp-t">Household</div>
    <div class="cmp-row">
      <div class="cmp-rl">Income</div>
      <div class="bar-wrap"><div class="bar-f b1" id="ib1">0%</div><div class="bar-f b2" id="ib2">0%</div></div>
      <div class="cmp-vals"><span id="iv1">$0</span><span id="iv2">$0</span></div>
    </div>
    <div class="cmp-row">
      <div class="cmp-rl">Expenses</div>
      <div class="bar-wrap"><div class="bar-f b1" id="eb1">0%</div><div class="bar-f b2" id="eb2">0%</div></div>
      <div class="cmp-vals"><span id="ev1">$0</span><span id="ev2">$0</span></div>
    </div>
    <div class="cmp-totals">
      <div><div class="bal-l">Income</div><div class="v green" id="hi">$0</div></div>
      <div><div class="bal-l">Expenses</div><div class="v" id="he">$0</div></div>
      <div><div class="bal-l">Balance</div><div class="v" id="hb">$0</div></div>
    </div>
  </div>

  <div class="add"><button class="add-b" id="addBtn">+ Add</button></div>

  <div class="fm" id="fm">
    <div class="fm-u">
      <button type="button" class="fm-ub u1 on" id="fu1">Me</button>
      <button type="button" class="fm-ub u2" id="fu2">Partner</button>
    </div>
    <form id="txF" class="fg">
      <input type="date" id="fDate" class="fi" required>
      <input type="text" id="fDesc" class="fi" placeholder="Description" required>
      <select id="fCat" class="fi" required><option value="">Category</option></select>
      <input type="number" id="fAmt" class="fi" placeholder="0.00" step="0.01" inputmode="decimal" required>
      <select id="fType" class="fi"><option value="Expense">Expense</option><option value="Income">Income</option></select>
      <div class="fa">
        <button type="button" class="btn bs" id="fCancel">Cancel</button>
        <button type="submit" class="btn bp" id="fSave">Save</button>
      </div>
    </form>
  </div>

  <div class="cg">
    <div class="sec"><div class="st">Categories</div><div class="ch"><canvas id="cC"></canvas></div></div>
    <div class="sec"><div class="st">Daily</div><div class="ch"><canvas id="dC"></canvas></div></div>
  </div>

  <div class="sec"><div class="st">Budgets</div><div id="bud"><div class="spin"></div></div></div>
  <div class="sec"><div class="st">Transactions</div><div id="txs"><div class="spin"></div></div></div>
</main>

<!-- Settings -->
<div class="mo" id="modal">
  <div class="mo-bg" id="moBg"></div>
  <div class="mo-b">
    <div class="mo-h"><h2>Settings</h2><button class="mo-x" id="moX">×</button></div>
    <div class="mo-d">
      <div class="sg"><label class="sl">Google Script URL</label><input type="text" id="apiI" class="si" placeholder="https://script.google.com/..."><p class="sh">Your deployed Apps Script URL</p></div>
      <div class="sg"><label class="sl">Names</label><div class="sr"><input type="text" id="n1" class="si" placeholder="You" style="border-left:3px solid var(--bl)"><input type="text" id="n2" class="si" placeholder="Partner" style="border-left:3px solid var(--pu)"></div></div>
      <div class="sg"><label class="sl">Budgets (per person)</label><div id="catL"></div></div>
    </div>
    <div class="mo-f"><button class="btn bp" id="savS">Save</button></div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<script src="config.js"></script>
<script src="app.js"></script>
</body>
</html>